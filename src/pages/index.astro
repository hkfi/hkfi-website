---
import Layout from '../layouts/Layout.astro'
import PostLink from '@/components/PostLink.astro'
import ScrollReveal from '@/components/ScrollReveal.astro'
import { getAllPosts, getAllPostCardData } from '@/libs/notion/client'

import ThinkingEmoji from '@/components/ThinkingEmoji'

// import SplineAvatar from '@/components/SplineAvatar.astro'

const blogPosts = await getAllPosts().then((res) => {
  return res.slice(0, 5)
})
const cardDataMap = await getAllPostCardData()
---

<Layout
  title='hkfi'
  seo={{
    description:
      'Portfolio and engineering blog of Hiroki Furuichi, a software engineer building web experiences with TypeScript and Python.'
  }}
>
  <div class='flex w-full justify-between p-4 items-center'>
    <ScrollReveal animation='fade-up' duration={700} class='flex min-h-[400px] flex-grow flex-col justify-center gap-4'>
      <div class='text-5xl font-extrabold tracking-tight md:text-6xl'>
        Hello <span class='animate-pulse'>ðŸ‘‹</span>
      </div>
      <div class='text-5xl font-bold tracking-tight text-default/90 md:text-6xl'>
        I'm <span class='text-primary'>Hiroki</span>
      </div>
      <div class='text-2xl font-medium text-default/80'>
        <span class='text-primary'>Software Engineer</span>
      </div>
      <div class='max-w-xl text-lg text-default/60'>
        Building web experiences with TypeScript and Python
      </div>
    </ScrollReveal>
    <div class='h-[400px] w-[200px] lg:w-[400px]' id='eye-3d' data-parallax='0.08'>
      <ThinkingEmoji client:only="react">
         <div slot="fallback" class="w-full h-full flex items-center justify-center">
            <span class="text-[180px] animate-pulse">ðŸ¤”</span>
         </div>
      </ThinkingEmoji>
    </div>
  </div>

  <ScrollReveal animation='fade-up' delay={100} class='mb-6 mt-12 text-3xl font-bold tracking-tight px-3'>
    Recent Posts
  </ScrollReveal>

  <ScrollReveal
    animation='fade-up'
    stagger={100}
    class='grid w-full grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3'
  >
    {
      blogPosts?.map((blogPost) => {
        return (
          <div>
            <PostLink post={blogPost} cardData={cardDataMap.get(blogPost.id)} />
          </div>
        )
      })
    }
  </ScrollReveal>
</Layout>
